{"version":3,"file":"index.umd.js","sources":["../src/providers/ProductHomeProvider.tsx","../src/utils.ts","../src/apis.ts","../src/hooks/useEvents.ts","../src/hooks/useFeature.ts"],"sourcesContent":["// MyProvider.tsx\nimport React, { createContext, ReactNode, useState } from 'react';\n\ninterface MyContextProps {\n    publicKey?: string;\n    userId?: string;\n    identity?: (userId: string) => void;\n    anonymousId?: string;\n    // triggerEvent: (eventId:string,properties:EventProperties,featureId?:string) => void;\n}\n\nexport const ProductHouseContext = createContext<MyContextProps>({});\n\n// todo need to verify origin + publicKey\ninterface ProductHomeProviderProps {\n    publicKey: string;\n    children: ReactNode;\n}\n\nlet anonymousId = \"\";\nif (localStorage.getItem(\"p_a_id\")) {\n    anonymousId = localStorage.getItem(\"p_a_id\") as string;\n} else {\n    anonymousId = Math.random().toString(36).substring(7);\n    localStorage.setItem(\"p_a_id\", anonymousId);\n}\nconsole.log(\"provider loaded\")\nexport const ProductHomeProvider: React.FC<ProductHomeProviderProps> = ({\n    children,\n    publicKey\n}: ProductHomeProviderProps) => {\n    const [userId, setUserId] = useState<string>();\n\n    const identity = (userId: string) => {\n        setUserId(userId);\n        // TODO: We need an API for identifying to make the connection between anonymous and user\n    };\n\n    return (\n        <ProductHouseContext.Provider value={{ publicKey, userId, identity, anonymousId }}>\n            {children}\n        </ProductHouseContext.Provider>\n    );\n};\n","\n\nexport const buildEventName = (context:string,featureName:string,resource:string,action:string)=>{\n    return `${featureName}:${resource}:${action}`\n}","import {AnalyticsRequest, ProductHouseFeature} from \"./Types\";\nconst baseUrl = \"http://localhost:8005\"\n\n// todo neeed to handle no internet connection - queue?\nexport const postEvent =async  (event:AnalyticsRequest)=>{\n        console.log(\"postEvent\")\n\n    const url = baseUrl+\"/v1/analytics/events\";\n    try {\n     await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(event)\n      });\n        console.log(\"here\")\n      // const result = await response.json();\n      // setResponse(result);\n    } catch (error) {\n        console.error(\"here\",error)\n      // setError(error.toString());\n        console.warn(\"Failed to send event\",error)\n    }\n\n}\n\n\nexport const getFeatures =():ProductHouseFeature[]=>{\n    // add queryParam with base 64 context - key,user etc.\n    return []\n}\n","// useMyFeature.ts\nimport {useContext} from 'react';\nimport {ProductHouseContext} from '../providers/ProductHomeProvider';\nimport {AnalyticsRequest, EventProperties} from \"../Types\";\nimport {postEvent} from \"../apis\";\nimport {buildEventName} from \"../utils\";\n\nexport const useEvents = () => {\n    const {publicKey, userId, identity, anonymousId} = useContext(ProductHouseContext);\n\n    const featureFlag = false;\n    const triggerEvent = (eventId: string, properties: EventProperties, featureId?: string) => {\n\n        const data:AnalyticsRequest = {\n            event_id: eventId,\n            feature_id: featureId,\n            properties,\n            user_id: userId,\n            anonymous_id: anonymousId,\n            key: publicKey as string\n        }\n        postEvent(data)\n            .then()\n            .catch()\n    }\n\n    return {identity,triggerEvent, buildEventName};\n\n\n};\n\n","import {useContext} from 'react';\nimport {ProductHouseContext} from '../providers/ProductHomeProvider';\nimport {AnalyticsRequest, EventProperties} from \"../Types\";\nimport {buildEventName} from \"../utils\";\nimport {postEvent} from \"../apis\";\n\nexport const useFeature = (featureId: string) => {\n    const {publicKey, userId, identity,anonymousId} = useContext(ProductHouseContext);\n    const featureFlag = true;\n\n    const triggerEvent = (eventId: string, properties: EventProperties) => {\n    console.log(\"triggering event\")\n        const data:AnalyticsRequest = {\n            event_id: eventId,\n            feature_id: featureId,\n            properties,\n            user_id: userId,\n            anonymous_id:anonymousId,\n            key: publicKey as string\n        }\n        postEvent(data)\n            .then()\n            .catch()\n    }\n\n    return {featureFlag, triggerEvent, buildEventName, identity};\n\n};\n\n"],"names":["ProductHouseContext","createContext","anonymousId","localStorage","getItem","Math","random","toString","substring","setItem","console","log","buildEventName","context","featureName","resource","action","postEvent","event","_temp","Promise","resolve","fetch","baseUrl","method","headers","body","JSON","stringify","then","_catch","error","warn","e","reject","_ref","children","publicKey","_useState","useState","setUserId","React","Provider","value","userId","identity","_useContext","useContext","triggerEvent","eventId","properties","featureId","event_id","feature_id","user_id","anonymous_id","key","featureFlag"],"mappings":"2WAWaA,EAAsBC,EAAaA,cAAiB,IAQ7DC,EAAc,GACdC,aAAaC,QAAQ,UACrBF,EAAcC,aAAaC,QAAQ,WAEnCF,EAAcG,KAAKC,SAASC,SAAS,IAAIC,UAAU,GACnDL,aAAaM,QAAQ,SAAUP,IAEnCQ,QAAQC,IAAI,mBACC,ICzBAC,EAAiB,SAACC,EAAeC,EAAmBC,EAAgBC,GAC7E,OAAUF,EAAeC,IAAAA,EAAYC,IAAAA,CACzC,ECAaC,WAAmBC,GAAsB,IAC9CR,QAAQC,IAAI,aAEhB,IAA2CQ,0BACvCC,QAAAC,QACGC,MAFKC,4CAEM,CACdC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUV,MACrBW,gBACAnB,QAAQC,IAAI,OAAO,4DAToBmB,CAAA,WAYlCC,GACLrB,QAAQqB,MAAM,OAAOA,GAErBrB,QAAQsB,KAAK,uBAAuBD,EACvC,UAAAX,QAAAC,QAAAF,GAAAA,EAAAU,KAAAV,EAAAU,KAAA,WAAA,QAAA,EAEL,CAAC,MAAAI,UAAAb,QAAAc,OAAAD,2BFEsE,SAAvCE,GAC5B,IAAAC,EAAQD,EAARC,SACAC,EAASF,EAATE,UAEAC,EAA4BC,EAAAA,WAAbC,EAASF,EAAA,GAOxB,OACIG,wBAACzC,EAAoB0C,SAAS,CAAAC,MAAO,CAAEN,UAAAA,EAAWO,OARzCN,KAQiDO,SAN7C,SAACD,GACdJ,EAAUI,EAEd,EAGwE1C,YAAAA,IAC/DkC,EAGb,cGpCyB,WACrB,IAAAU,EAAmDC,EAAUA,WAAC/C,GAAvDqC,EAASS,EAATT,UAAWO,EAAME,EAANF,OAAkB1C,EAAW4C,EAAX5C,YAkBpC,MAAO,CAAC2C,SAlB0BC,EAARD,SAkBTG,aAfI,SAACC,EAAiBC,EAA6BC,GAUhElC,EAR8B,CAC1BmC,SAAUH,EACVI,WAAYF,EACZD,WAAAA,EACAI,QAASV,EACTW,aAAcrD,EACdsD,IAAKnB,IAGJR,cAET,EAE+BjB,eAAAA,EAGnC,eCvB0B,SAACuC,GACvB,IAAAL,EAAkDC,EAAUA,WAAC/C,GAAtDqC,EAASS,EAATT,UAAWO,EAAME,EAANF,OAAiB1C,EAAW4C,EAAX5C,YAkBnC,MAAO,CAACuD,aAjBY,EAiBCT,aAfA,SAACC,EAAiBC,GACvCxC,QAAQC,IAAI,oBASRM,EAR8B,CAC1BmC,SAAUH,EACVI,WAAYF,EACZD,WAAAA,EACAI,QAASV,EACTW,aAAarD,EACbsD,IAAKnB,IAGJR,OACK,OACd,EAEmCjB,eAAAA,EAAgBiC,SAlBjBC,EAARD,SAoB9B"}