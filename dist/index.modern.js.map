{"version":3,"file":"index.modern.js","sources":["../src/providers/ProductHomeProvider.tsx","../src/utils.ts","../src/apis.ts","../src/hooks/useFeature.ts","../src/hooks/useEvents.ts"],"sourcesContent":["// MyProvider.tsx\nimport React, { createContext, ReactNode, useState } from 'react';\n\ninterface MyContextProps {\n    publicKey?: string;\n    userId?: string;\n    identity?: (userId: string) => void;\n    anonymousId?: string;\n    // triggerEvent: (eventId:string,properties:EventProperties,featureId?:string) => void;\n}\n\nexport const ProductHouseContext = createContext<MyContextProps>({});\n\n// todo need to verify origin + publicKey\ninterface ProductHomeProviderProps {\n    publicKey: string;\n    children: ReactNode;\n}\n\nlet anonymousId = \"\";\nif (localStorage.getItem(\"p_a_id\")) {\n    anonymousId = localStorage.getItem(\"p_a_id\") as string;\n} else {\n    anonymousId = Math.random().toString(36).substring(7);\n    localStorage.setItem(\"p_a_id\", anonymousId);\n}\nconsole.log(\"provider loaded\")\nexport const ProductHomeProvider: React.FC<ProductHomeProviderProps> = ({\n    children,\n    publicKey\n}: ProductHomeProviderProps) => {\n    const [userId, setUserId] = useState<string>();\n\n    const identity = (userId: string) => {\n        setUserId(userId);\n        // TODO: We need an API for identifying to make the connection between anonymous and user\n    };\n\n    return (\n        <ProductHouseContext.Provider value={{ publicKey, userId, identity, anonymousId }}>\n            {children}\n        </ProductHouseContext.Provider>\n    );\n};\n","\n\nexport const buildEventName = (context:string,featureName:string,resource:string,action:string)=>{\n    return `${featureName}:${resource}:${action}`\n}","import {AnalyticsRequest, ProductHouseFeature} from \"./Types\";\nconst baseUrl = \"http://localhost:8005\"\n\n// todo neeed to handle no internet connection - queue?\nexport const postEvent =async  (event:AnalyticsRequest)=>{\n        console.log(\"postEvent\")\n\n    const url = baseUrl+\"/v1/analytics/events\";\n    try {\n     await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(event)\n      });\n        console.log(\"here\")\n      // const result = await response.json();\n      // setResponse(result);\n    } catch (error) {\n        console.error(\"here\",error)\n      // setError(error.toString());\n        console.warn(\"Failed to send event\",error)\n    }\n\n}\n\n\nexport const getFeatures =():ProductHouseFeature[]=>{\n    // add queryParam with base 64 context - key,user etc.\n    return []\n}\n","import {useContext} from 'react';\nimport {ProductHouseContext} from '../providers/ProductHomeProvider';\nimport {AnalyticsRequest, EventProperties} from \"../Types\";\nimport {buildEventName} from \"../utils\";\nimport {postEvent} from \"../apis\";\n\nexport const useFeature = (featureId: string) => {\n    const {publicKey, userId, identity,anonymousId} = useContext(ProductHouseContext);\n    const featureFlag = true;\n\n    const triggerEvent = (eventId: string, properties: EventProperties) => {\n    console.log(\"triggering event\")\n        const data:AnalyticsRequest = {\n            event_id: eventId,\n            feature_id: featureId,\n            properties,\n            user_id: userId,\n            anonymous_id:anonymousId,\n            key: publicKey as string\n        }\n        postEvent(data)\n            .then()\n            .catch()\n    }\n\n    return {featureFlag, triggerEvent, buildEventName, identity};\n\n};\n\n","// useMyFeature.ts\nimport {useContext} from 'react';\nimport {ProductHouseContext} from '../providers/ProductHomeProvider';\nimport {AnalyticsRequest, EventProperties} from \"../Types\";\nimport {postEvent} from \"../apis\";\nimport {buildEventName} from \"../utils\";\n\nexport const useEvents = () => {\n    const {publicKey, userId, identity, anonymousId} = useContext(ProductHouseContext);\n\n    const featureFlag = false;\n    const triggerEvent = (eventId: string, properties: EventProperties, featureId?: string) => {\n\n        const data:AnalyticsRequest = {\n            event_id: eventId,\n            feature_id: featureId,\n            properties,\n            user_id: userId,\n            anonymous_id: anonymousId,\n            key: publicKey as string\n        }\n        postEvent(data)\n            .then()\n            .catch()\n    }\n\n    return {identity,triggerEvent, buildEventName};\n\n\n};\n\n"],"names":["ProductHouseContext","createContext","anonymousId","localStorage","getItem","Math","random","toString","substring","setItem","console","log","ProductHomeProvider","children","publicKey","userId","setUserId","useState","React","Provider","value","identity","buildEventName","context","featureName","resource","action","postEvent","async","fetch","baseUrl","method","headers","body","JSON","stringify","event","error","warn","useFeature","featureId","useContext","featureFlag","triggerEvent","eventId","properties","event_id","feature_id","user_id","anonymous_id","key","then","catch","useEvents"],"mappings":"uEAWO,MAAMA,EAAsBC,EAA8B,CAAA,GAQjE,IAAIC,EAAc,GACdC,aAAaC,QAAQ,UACrBF,EAAcC,aAAaC,QAAQ,WAEnCF,EAAcG,KAAKC,SAASC,SAAS,IAAIC,UAAU,GACnDL,aAAaM,QAAQ,SAAUP,IAEnCQ,QAAQC,IAAI,mBACC,MAAAC,EAA0DA,EACnEC,WACAC,gBAEA,MAAOC,EAAQC,GAAaC,IAO5B,OACIC,gBAAClB,EAAoBmB,SAAS,CAAAC,MAAO,CAAEN,YAAWC,SAAQM,SAN5CN,IACdC,EAAUD,EAAM,EAKoDb,gBAC/DW,EAAQ,ECtCRS,EAAiBA,CAACC,EAAeC,EAAmBC,EAAgBC,IACtE,GAAGF,KAAeC,KAAYC,ICC5BC,EAAWC,UAChBlB,QAAQC,IAAI,aAGhB,UACOkB,MAFKC,4CAEM,CACdC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUC,KAErB1B,QAAQC,IAAI,OAGf,CAAC,MAAO0B,GACL3B,QAAQ2B,MAAM,OAAOA,GAErB3B,QAAQ4B,KAAK,uBAAuBD,EACvC,GCjBQE,EAAcC,IACvB,MAAM1B,UAACA,EAASC,OAAEA,EAAMM,SAAEA,EAAQnB,YAACA,GAAeuC,EAAWzC,GAkB7D,MAAO,CAAC0C,aAjBY,EAiBCC,aAfAA,CAACC,EAAiBC,KACvCnC,QAAQC,IAAI,oBASRgB,EAR8B,CAC1BmB,SAAUF,EACVG,WAAYP,EACZK,aACAG,QAASjC,EACTkC,aAAa/C,EACbgD,IAAKpC,IAGJqC,OACAC,OACT,EAEmC9B,iBAAgBD,WAAQ,EClBlDgC,EAAYA,KACrB,MAAMvC,UAACA,EAASC,OAAEA,EAAMM,SAAEA,EAAQnB,YAAEA,GAAeuC,EAAWzC,GAkB9D,MAAO,CAACqB,WAASsB,aAfIA,CAACC,EAAiBC,EAA6BL,KAUhEb,EAR8B,CAC1BmB,SAAUF,EACVG,WAAYP,EACZK,aACAG,QAASjC,EACTkC,aAAc/C,EACdgD,IAAKpC,IAGJqC,OACAC,OAAK,EAGiB9B"}