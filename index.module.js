import e,{createContext as t,useState as n,useContext as r}from"react";import{v4 as o}from"uuid";function i(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var c="https://product-server-chc1.onrender.com",u=function(e){try{var t=c+"/v1/api/e",n=i(function(){return Promise.resolve(fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).then(function(){})},function(e){console.error("here",e),console.warn("Failed to send event",e)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},a=t({}),d="";localStorage.getItem("p_a_id")?d=localStorage.getItem("p_a_id"):(d=o(),localStorage.setItem("p_a_id",d));var s=function(t){var r=t.children,o=t.publicKey,u=n(),s=u[1];return e.createElement(a.Provider,{value:{publicKey:o,userId:u[0],identity:function(e,t){s(e),function(e){try{var t=c+"/v1/api/i",n=i(function(){return Promise.resolve(fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).then(function(){})},function(e){console.error("here",e),console.warn("Failed to send event",e)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}({user_id:e,properties:t,anonymous_id:d,key:o}).then().catch()},anonymousId:d}},r)},l=function(e,t,n,r){return t+":"+n+":"+r},v=function(e){var t=r(a),n=t.publicKey,o=t.userId,i=t.anonymousId;return{featureFlag:!0,triggerEvent:function(t,r){console.log("triggering event"),u({event_id:t,feature_id:e,properties:r,user_id:o,anonymous_id:i,key:n}).then().catch()},buildEventName:l,identity:t.identity}},h=function(){var e=r(a),t=e.publicKey,n=e.userId,o=e.anonymousId;return{identity:e.identity,triggerEvent:function(e,r,i){u({event_id:e,feature_id:i,properties:r,user_id:n,anonymous_id:o,key:t}).then().catch()},buildEventName:l}};export{s as ProductHomeProvider,h as useEvents,v as useFeature};
//# sourceMappingURL=index.module.js.map
